CREATE SCHEMA `wear`;
USE `wear` ;
CREATE TABLE IF NOT EXISTS `role` ( `id` INT NOT NULL AUTO_INCREMENT, `name` VARCHAR(45) NOT NULL, PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `user` ( `id` INT NOT NULL AUTO_INCREMENT, `username` VARCHAR(45) NOT NULL, `password` VARCHAR(45) NOT NULL, `fio` VARCHAR(45) NOT NULL, `role_id` INT NOT NULL, `hidden` INT NOT NULL DEFAULT '0', PRIMARY KEY (`id`), INDEX `fk_user_role_idx` (`role_id` ASC) VISIBLE, CONSTRAINT `fk_user_role` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `supplier` ( `id` INT NOT NULL AUTO_INCREMENT, `name` VARCHAR(45) NOT NULL, `address` VARCHAR(45) NOT NULL, `phone` VARCHAR(45) NOT NULL, `hidden` INT NOT NULL DEFAULT '0', PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `client` ( `id` INT NOT NULL AUTO_INCREMENT, `fio` VARCHAR(45) NOT NULL, `phone` VARCHAR(45) NOT NULL, `hidden` INT NOT NULL DEFAULT '0', PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `wear` ( `id` INT NOT NULL AUTO_INCREMENT, `name` VARCHAR(45) NOT NULL, `amount` INT NOT NULL, `supplier_id` INT NOT NULL, `hidden` INT NOT NULL DEFAULT '0', PRIMARY KEY (`id`), INDEX `fk_wear_supplier1_idx` (`supplier_id` ASC) VISIBLE, CONSTRAINT `fk_wear_supplier1` FOREIGN KEY (`supplier_id`) REFERENCES `supplier` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `status` ( `id` INT NOT NULL AUTO_INCREMENT, `name` VARCHAR(45) NOT NULL, PRIMARY KEY (`id`)) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `invoice` ( `id` INT NOT NULL AUTO_INCREMENT, `date` DATETIME NOT NULL, `client_id` INT NOT NULL, `user_id` INT NOT NULL, `status_id` INT NOT NULL, PRIMARY KEY (`id`), INDEX `fk_invoice_client1_idx` (`client_id` ASC) VISIBLE, INDEX `fk_invoice_user1_idx` (`user_id` ASC) VISIBLE, INDEX `fk_invoice_status1_idx` (`status_id` ASC) VISIBLE, CONSTRAINT `fk_invoice_client1` FOREIGN KEY (`client_id`) REFERENCES `client` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION, CONSTRAINT `fk_invoice_user1` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION, CONSTRAINT `fk_invoice_status1` FOREIGN KEY (`status_id`) REFERENCES `status` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
CREATE TABLE IF NOT EXISTS `invoice_has_wear` ( `invoice_id` INT NOT NULL, `wear_id` INT NOT NULL, `amount` INT NOT NULL, PRIMARY KEY (`invoice_id`, `wear_id`), INDEX `fk_invoice_has_wear_wear1_idx` (`wear_id` ASC) VISIBLE, INDEX `fk_invoice_has_wear_invoice1_idx` (`invoice_id` ASC) VISIBLE, CONSTRAINT `fk_invoice_has_wear_invoice1` FOREIGN KEY (`invoice_id`) REFERENCES `invoice` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION, CONSTRAINT `fk_invoice_has_wear_wear1` FOREIGN KEY (`wear_id`) REFERENCES `wear` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE = InnoDB;
INSERT INTO `role` VALUES (1,'Кладовщик'),(2,'Администратор');
INSERT INTO `user` VALUES (1,'root','63a9f0ea7bb98050796b649e85481845','root',2,0);
INSERT INTO `status` VALUES (1,'Сборка'),(2,'Готов к выдаче'),(3,'Выдан');